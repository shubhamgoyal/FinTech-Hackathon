!function(){"use strict";function e(e,t){return t.getConversation(e.current.params.cid)}function t(t,o,n,r,s){s.theme("default").primaryPalette("blue").accentPalette("blue-grey"),t.when("/dashboard",{templateUrl:n.base_url+"assets/zpartials/emplr-main.html",controller:"EmployerDashMainCtrl"}).when("/inbox",{templateUrl:n.base_url+"assets/zpartials/inbox.html",controller:"inboxCtrl"}).when("/inbox/conversation/:cid/:jid?",{templateUrl:n.base_url+"assets/zpartials/conversation.html",controller:"conversationCtrl",resolve:{gconv:e}}).when("/jobs",{templateUrl:n.base_url+"assets/zpartials/emplr-jobs.html",controller:"EmployerDashMainCtrl"}).when("/jobcreate",{templateUrl:n.base_url+"assets/zpartials/emplr-job-create.html",controller:"EmployerDashCreateJobCtrl"}).when("/applications/jobid/:jobid/jobtitle/:jobtitle",{templateUrl:n.base_url+"assets/zpartials/emplr-job-applications.html",controller:"candApplicationCtrl"}).when("/applications/jobid/:jobid",{templateUrl:n.base_url+"assets/zpartials/emplr-job-applications.html",controller:"candApplicationCtrl"}).when("/job/jobid/:jobid",{templateUrl:n.base_url+"assets/zpartials/emplr-job-details.html",controller:"jobDetailsCtrl"}).when("/jobedit/jobid/:jobid",{templateUrl:n.base_url+"assets/zpartials/emplr-job-edit.html",controller:"jobDetailsCtrl"}).when("/profile",{templateUrl:n.base_url+"assets/zpartials/emplr-profile.html",controller:"EmployerProfileCrtl"}).when("/profileedit",{templateUrl:n.base_url+"assets/zpartials/emplr-profile-edit.html",controller:"EmployerProfileCrtl"}).when("/adv",{templateUrl:n.base_url+"assets/zpartials/emplr-srch-adv.html",controller:"jobsCrtl"}).when("/building",{templateUrl:n.base_url+"assets/zpartials/srch-building.html",controller:"employersCrtl"}).when("/employers",{templateUrl:n.base_url+"assets/zpartials/srch-emplr.html",controller:"employersCrtl"}).when("/media",{templateUrl:n.base_url+"assets/zpartials/media.html",controller:"employersCrtl"}).when("/home",{templateUrl:n.base_url+"assets/zpartials/emplr-home.html",controller:"jobsCrtl"}).when("/firetapa",{templateUrl:n.base_url+"assets/zpartials/empl-firetap-a.html",controller:"jobsCrtl"}).when("/firetapf",{templateUrl:n.base_url+"assets/zpartials/empl-firetap-f.html",controller:"jobsCrtl"}).when("/firetapp",{templateUrl:n.base_url+"assets/zpartials/empl-firetap-p.html",controller:"jobsCrtl"}).when("/applied",{templateUrl:n.base_url+"assets/zpartials/applied.html",controller:"employersCrtl"}).when("/forgetpwd",{templateUrl:n.base_url+"assets/zpartials/emplr-forgetpwd.html",controller:"ForgetCtrl"}).when("/forgetpwd/:resettoken",{templateUrl:n.base_url+"assets/zpartials/emplr-forgetpwd.html",controller:"ForgetCtrl"}).when("/login",{templateUrl:n.base_url+"assets/zpartials/emplr-login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:n.base_url+"assets/zpartials/emplr-register.html",controller:"RegisterCtrl"}).when("/landing",{templateUrl:n.base_url+"assets/zpartials/empl-landing-dynamic.html",controller:"employersCrtl"}).when("/landcreate",{templateUrl:n.base_url+"assets/zpartials/empl-landing-add.html",controller:"employersCrtl"}).when("/landedit/:landingId",{templateUrl:n.base_url+"assets/zpartials/empl-landing-edit.html",controller:"employersCrtl"}).when("/go/:companyname",{templateUrl:n.base_url+"assets/zpartials/empl-landing-public.html",controller:"employerslandingCrtl"}).when("/verifymail/:verificationcode",{templateUrl:n.base_url+"assets/zpartials/emplr-email-verify.html",controller:"VerifyCtrl"}).when("/verifyadmail/:verificationcode",{templateUrl:n.base_url+"assets/zpartials/emplr-email-verify.html",controller:"VerifyAdminCtrl"}).when("/candapplication/candid/:candid/applid/:application_id/shortlisted/:shortlisted",{templateUrl:n.base_url+"assets/zpartials/emplr-cand-view.html",controller:"candApplicationCtrl"}).when("/stats",{templateUrl:n.base_url+"assets/zpartials/emplr-stats.html",controller:"statsCtrl"}).when("/admin",{templateUrl:n.base_url+"assets/zpartials/admin-panel.html",controller:"AdminCtrl"}).when("/adminprofile",{templateUrl:n.base_url+"assets/zpartials/admin-profile-edit.html",controller:"AdminProfileCtrl"}).when("/adminregister",{templateUrl:n.base_url+"assets/zpartials/admin-register.html",controller:"AdminRegisterCtrl"}).when("/admin/:emp_id/:url*",{templateUrl:n.base_url+"assets/zpartials/emplr-email-verify.html",controller:"AdminCtrl"}).when("/calendar",{templateUrl:n.base_url+"assets/zpartials/emplr-calendar.html",controller:"CalendarCtrl"}).otherwise({redirectTo:"/dashboard"})}var o=angular.module("myApp");t.$inject=["$routeProvider","$httpProvider","ENV","$locationProvider","$mdThemingProvider"],e.$inject=["$route","InboxManager"],o.config(t)}(),function(){"use strict";function e(e){e.setOptions({colours:["#FF5252","#FF8A80"],responsive:!0,animation:!0}),e.setOptions("Line",{datasetFill:!0}),e.setOptions("Bar",{colours:["rgba(151,187,205,1)"]})}var t=angular.module("myApp");e.$inject=["ChartJsProvider"],t.config(e)}(),function(){"use strict";function e(e){}var t=angular.module("myApp");e.$inject=["cfpLoadingBarProvider"],t.config(e)}(),function(){"use strict";function e(e,t){e.defaults={target:t.base_url+"emplanding/uploader",permanentErrors:[404,500,501],maxChunkRetries:1,chunkRetryInterval:5e3,simultaneousUploads:4,singleFile:!0},e.on("catchAll",function(e){console.log("catchAll",arguments)}),e.on("filesSubmitted",function(e){console.log("prevent default")})}var t=angular.module("myApp");e.$inject=["flowFactoryProvider","ENV"],t.config(e)}(),function(){"use strict";function e(e,t){e.templateUrl=t.base_url+"assets/components/angular-lightbox/lightbox.html"}var t=angular.module("myApp");e.$inject=["LightboxProvider","ENV"],t.config(e)}(),function(){"use strict";function e(e,t,o){return{restrict:"A",require:"ngModel",link:function(n,r,s,a){var i;return n.$watch(function(){return a.$modelValue},function(r){e.cancel(i),""===r&&a.$setValidity("unique",!0),console.log(o.rest_server+"employers/EmployerLandingPageList/:companypagename?token="+n.token);var s=t(o.rest_server+"employers/EmployerLandingPageList/:companypagename?token="+n.token,{companypagename:"@companypagename"});i=e(function(){s.query({companypagename:r},function(e){return console.log(e.length),a.$setValidity("unique",0===e.length)})},200)})}}}var t=angular.module("myApp");e.$inject=["$timeout","$resource","ENV"],t.directive("nameUnique",e)}(),function(){"use strict";function e(){return{restrict:"AEC",require:"ngModel",link:function(e,t,o,n){var r="#"+o.pwCheck;$(t).add(r).on("keyup",function(){e.$apply(function(){if(""!=$(t).val()&&""!=$(r).val()){var e=$(t).val()===$(r).val();console.log("tell me v: "+e),n.$setValidity("pwmatch",e)}})})}}}var t=angular.module("myApp");t.directive("pwCheck",e)}(),function(){"use strict";function e(e,t,o){o.searchfields=[],o.searchreference={categories:{},towns:{},types:{}},e.get(t.rest_server+"searchfields").success(function(e){o.searchfields=e;for(var t in e)for(var n=e[t],r=0;r<n.length;r++){var s=n[r];o.searchreference[t][s.id]=s.name}}).error(function(e,t){return console.log("getSearchFields -> failed to get response"),!1})}var t=angular.module("myApp");e.$inject=["$http","ENV","$rootScope"],t.service("mySearchFields",e)}(),function(){"use strict";function e(e){this.srch={keyword:"",currentPage:"1",entryLimit:"5",filteredItems:"",totalItems:"",cat:"",catname:"",type:"",typename:"",town:"",townname:""};this.getKeyword=function(){return this.srch.keyword},this.searchJobs=function(e){this.srch.keywords=e.keywords},this.setCategory=function(e,t){this.srch.cat=e,this.srch.catname=t},this.setType=function(e,t){this.srch.type=e,this.srch.typeName=t},this.setTown=function(e,t){this.srch.town=e,this.srch.townName=t},this.resetSrch=function(){console.log("Inside resetSrch"),this.srch.keyword="",this.srch.currentPage="",this.srch.entryLimit="",this.srch.filteredItems="",this.srch.totalItems="",this.srch.cat="",this.srch.catname="",this.srch.type="",this.srch.typename="",this.srch.town="",this.srch.townname=""}}var t=angular.module("myApp");e.$inject=["$http"],t.service("mySearch",e)}(),function(){"use strict";function e(e){this.name=e.get("name"),this.subname=e.get("name"),this.company=e.get("employer_token"),this.loggedIn=function(){return this.hasEmployerToken()||this.hasAdminToken()},this.hasEmployerToken=function(){var t=e.get("employer_token");return void 0==t||""==t?!1:!0},this.hasAdminToken=function(){var t=e.get("admin_token");return void 0==t||""==t?!1:!0}}var t=angular.module("myApp");e.$inject=["$cookieStore"],t.service("mySession",e)}(),function(){"use strict";function e(e,t){this.invited="",this.invited_date="",this.shortlist=function(o,n){console.info(o.shortlisted),e({url:t.rest_server+"applications?token="+n,method:"PUT",data:o,headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(e,t){return o.shortlisted=e.shortlisted.toString(),console.info(e),console.log("Shortlisting successful"),!0}).error(function(e,t){return console.log("Problem shortlisting: "+t),!1})},this.changeStatus=function(o,n,r,s,a){e({url:t.rest_server+"applications?token="+r,method:"PUT",data:{application_id:o,cand_id:n.id,status:s},headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(e,t){return a.status=e.status.toString(),!0}).error(function(e,t){return!1})}}var t=angular.module("myApp");e.$inject=["$http","ENV"],t.service("candShortlist",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a){if(e.token=r.get("admin_token"),void 0==e.token)return n.path("/login"),!1;a.emp_id,a.job_id}var t=angular.module("myApp");e.$inject=["$scope","$http","$timeout","$location","$cookieStore","ENV","$routeParams"],t.controller("AdminRouteCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a){e.token=o.get("admin_token"),void 0!==e.token?console.log("AdminRegisterCtrl -> Admin already logged in."):(e.token=!1,e.showError=!1),e.registerFn=function(o,s){return $(s.target).button("loading"),o&&o.email&&o.password?void t.post(r.rest_server+"admin",o).success(function(t,o,r,i){console.log(t),console.log(o),$(s.target).button("reset"),201===o||200===o?(a.show(a.alert().parent(angular.element(document.body)).title("Registration").content("You have successfully registered, please login. Thank you").ariaLabel("Registration").ok("OK!").targetEvent()),n.path("/login")):e.showError=!0}).error(function(t,o,n,r){switch(o){case 409:e.errormsg="Email already exists.";default:$(s.target).button("reset"),e.showError=!0}}):(e.errormsg="Email or password fields cannot be empty.",e.showError=!0,$(s.target).button("reset"),!1)}}var t=angular.module("myApp");e.$inject=["$scope","$http","$cookieStore","$location","ENV","$mdDialog"],t.controller("AdminRegisterCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a){e.token=r.get("admin_token"),e.profile={},t.get(s.rest_server+"admin?token="+e.token,{ignoreLoadingBar:!0}).success(function(t){e.profile=t,console.log("AdminProfileCtrl returned:"),console.info(t),e.showLoading=!1}),e.submitEdits=function(o){e.showPwdError=0,o.token=e.token,t({url:s.rest_server+"admin?token="+e.token,method:"PUT",data:o,headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o){e.profileForm.$setPristine(),e.profileFormAcct.$setPristine(),"passwordupdated"==t.msg?a.show(a.alert().parent(angular.element(document.body)).title("Success").content("Your password has been chnaged.").ariaLabel("Success").ok("OK!").targetEvent()):"emailupdated"==t.msg?a.show(a.alert().parent(angular.element(document.body)).title("Updated").content("Your email change request is accepted, please check your email and follow the verification instructions. Also, please logout.. Thank you").ariaLabel("Updated").ok("OK!").targetEvent()):a.show(a.alert().parent(angular.element(document.body)).title("Saved").content("Your records have been saved.").ariaLabel("Saved").ok("OK!").targetEvent()),n.path("/admin")}).error(function(t,o){"wrongpassword"==t.msg?(e.showPwdError=1,alert("saving failed due to wrong password")):n.path("/login")})}}var t=angular.module("myApp");e.$inject=["$scope","$http","$timeout","$location","$cookieStore","ENV","$mdDialog"],t.controller("AdminProfileCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a,i,l,c,u){return e.companies=[],e.token=r.get("admin_token"),e.errormsg="",e.new_company={adding:!1},void 0==e.token?(a.path("/login"),!1):(e.getEmployersUnderAdmin=function(){t.post(n.rest_server+"admin",{mode:"getemployers",token:e.token}).success(function(t,o,n,i){if(e.companies=t,console.log(u.emp_id+","+u.url),void 0!=u.emp_id){for(key in t)if(t[key].CMP_ID==u.emp_id)return e.changeCompany(t[key]),a.path(u.url),!0;return a.path("/admin"),!1}e.getstats(),r.get("company")&&(s.company=r.get("company"),s.subname=r.get("subname"),e.$emit("subname_upd",""),console.log("should be updating subname to: "+s.subname))}).error(function(e,t,o,n){})},e.getEmployersUnderAdmin(),e.isCurrentCompany=function(e){return r.get("company")==e.CMP_ID},e.changeCompany=function(t){r.remove("employer_token"),r.put("employer_token",t.CMP_TOKEN),r.remove("company"),r.put("company",t.CMP_ID),r.put("subname",t.CMP_NAME),s.company=t.CMP_ID,s.subname=t.CMP_NAME,e.$emit("loginout","")},e.addCompany=function(){return e.new_company.adding?!1:(e.new_company.adding=!0,e.errormsg="",e.new_company.email&&e.new_company.password?void t.post(n.rest_server+"admin",{mode:"createemployer",token:e.token,company:e.new_company}).success(function(t,o,n,r){e.getEmployersUnderAdmin(),e.new_company.email="",e.new_company.password="",e.new_company.adding=!1,e.showSimpleDialog("Done!","Your sub account has been created and added to your list. Please remember to update the profile to attract the best possible candidates!")}).error(function(t,o,n,r){409==o?e.errormsg="Email already exists.":e.errormsg="Unable to create new company.",e.new_company.adding=!1}):(e.errormsg="You need to provide company details.",e.new_company.adding=!1,!1))},e.setNotifications=function(o){o.NOTIFICATIONS||(o.NOTIFICATIONS=0),t.post(n.rest_server+"admin",{mode:"setnotifications",token:e.token,company:o}).success(function(e,t,n,r){console.log(e),o.NOTIFICATIONS=e}).error(function(e,t,o,n){})},void(e.getstats=function(){t.post(n.rest_server+"admin",{mode:"getstats",token:e.token}).success(function(t,o,n,r){e.mostvisits=t.mostvisits,e.mostviews=t.mostviews,e.mostfavs=t.mostfavs,console.log(t)}).error(function(e,t,o,n){})}))}var t=angular.module("myApp");e.$inject=["$scope","$http","$timeout","ENV","$cookieStore","mySession","$location","$mdDialog","$rootScope","InboxManager","$routeParams"],t.controller("AdminCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r){e.verificationcode=r.verificationcode,console.log(e.verificationcode),e.verificationmsg="",t.get(n.rest_server+"admin/emailverification/"+e.verificationcode).success(function(t,n,r,s){console.log("VerifyCtrl: AJAX is "+n),200===n?(console.log("VerifyCtrl: response msg "+t.msg),"emailchanged"==t.msg?confirm("Your email is updated, please use your new email to login.")&&(e.verificationcode="",o.path("/login")):"success"==t.msg?confirm("Your email is verified, please use your email to login.")&&(e.verificationcode="",o.path("/login")):confirm("Sorry, your email is not verified.Please try again")&&(e.verificationcode="",o.path("/login"))):confirm("Something went wrong.")&&(e.verificationcode="",o.path("/login"))}).error(function(t,o,n,r){console.log("Login AJAX Error! "+o),e.resettoken=""})}var t=angular.module("myApp");e.$inject=["$scope","$http","$location","ENV","$routeParams"],t.controller("VerifyAdminCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a){e.token=r.get("employer_token"),e.AWS_URL=s.aws_url,e.profile={},t.get(s.rest_server+"employers?token="+e.token).success(function(t){e.profile=t,console.log("EmployerProfileCtrl returned: "),console.info(t),e.showLoading=!1}),e.uploader={controllerFn:function(t,o,n){console.log(t,o,n),e.uploadermessage=angular.fromJson(n),e.profile.imageurl=e.uploadermessage.success}},e.submitEdits=function(o){e.showPwdError=0,o.token=e.token,t({url:s.rest_server+"employers?token="+e.token,method:"PUT",data:o,headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o){e.profileForm.$setPristine(),e.profileFormAcct.$setPristine(),console.log("EmployerProfileCrtl-> edited profile successfully>>:"),"passwordupdated"==t.msg?a.show(a.alert().parent(angular.element(document.body)).title("Updated").content("You have successfully changed your password!").ariaLabel("Updated").ok("OK!").targetEvent()):"emailupdated"==t.msg?a.show(a.alert().parent(angular.element(document.body)).title("Updated").content("Email change request is accepted, please verify the change by checking the verification email that has been sent. Also, please logout and log back in.").ariaLabel("Updated").ok("OK!").targetEvent()):a.show(a.alert().parent(angular.element(document.body)).title("Profile").content("Records saved!").ariaLabel("Saved").ok("OK!").targetEvent()),n.path("/profile")}).error(function(t,o){"wrongpassword"==t.msg?(e.showPwdError=1,alert("saving failed due to wrong password")):(console.log("EmployerProfileCrtl: Error editing profile"+o),a.show(a.alert().parent(angular.element(document.body)).title("Login session").content("Your session has expired, please login again. Thank you").ariaLabel("Expired").ok("OK!").targetEvent()),n.path("/login"))})},e.savePicture=function(t,o){console.log("called savePicture()"),e.submitEdits(t),o.cancel()},e.cancelPicture=function(o){o.cancel(),t.get(s.rest_server+"candidates?token="+e.token).success(function(t){e.profile=t,console.log("Retrieved User profile info: "),console.info(t)})}}var t=angular.module("myApp");e.$inject=["$scope","$http","$timeout","$location","$cookieStore","ENV","$mdDialog"],t.controller("EmployerProfileCrtl",e)}(),function(){"use strict";function e(e,t,o,n,r){e.verificationcode=r.verificationcode,console.log(e.verificationcode),e.verificationmsg="",t.get(n.rest_server+"employers/emailverification/"+e.verificationcode).success(function(t,n,r,s){console.log("VerifyCtrl: AJAX is "+n),200===n?(console.log("VerifyCtrl: response msg "+t.msg),"emailchanged"==t.msg?confirm("Your email is updated, please use your new email to login.")&&(e.verificationcode="",o.path("/login")):"success"==t.msg?confirm("Your email is verified, please use your email to login.")&&(e.verificationcode="",o.path("/login")):confirm("Sorry, your email is not verified.Please try again")&&(e.verificationcode="",o.path("/login"))):confirm("Something went wrong.")&&(e.verificationcode="",o.path("/login"))}).error(function(t,o,n,r){console.log("Login AJAX Error! "+o),e.resettoken=""})}var t=angular.module("myApp");e.$inject=["$scope","$http","$location","ENV","$routeParams"],t.controller("VerifyCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a){e.resettoken=s.resettoken,console.log(e.resettoken),e.EmailNotExist=!1,e.ResetMailSent=!1,e.forgetFn=function(o,n){console.log("ForgetCtrl: Called loginFn()"),console.log("ForgetCtrl: "+o),console.log("ForgetCtrl: "+n.target),$(n.target).button("loading"),t.post(r.rest_server+"employers/reset",o).success(function(t,o,r,s){console.log("ForgetCtrl: AJAX is "+o),200===o?(console.log("ForgetCtrl: response msg "+t.msg),"emailnotexist"==t.msg?a.show(a.alert().parent(angular.element(document.body)).title("Registration").content("Your email did not register, please try again.").ariaLabel("Registration").ok("OK!").targetEvent()):(e.resettoken="",a.show(a.alert().parent(angular.element(document.body)).title("Reset").content("A password reset link has been emailed to you.").ariaLabel("Reset").ok("OK!").targetEvent()))):(console.log("something went wrong: "+o),e.resettoken=""),setTimeout(function(){$(n.target).button("reset")},1e3)}).error(function(t,o,n,r){console.log("Login AJAX Error! "+o),e.resettoken=""})},e.changeFn=function(o,n){e.pwdchange.$valid&&(console.log("ForgetCtrl: Called changeFn()"),console.log("ForgetCtrl: "+o),console.log("ForgetCtrl: "+n.target),$(n.target).button("loading"),t.post(r.rest_server+"employers/changepwd/"+e.resettoken,o).success(function(t,o,n,r){console.log("ForgetCtrl: AJAX is "+o),200===o?(console.log("ForgetCtrl: response msg"+t.msg),"success"==t.msg?a.show(a.alert().parent(angular.element(document.body)).title("Updated").content("Your password has been updated, please logout and login using your new password. Thank you.").ariaLabel("Updated").ok("OK!").targetEvent()):"tokenexpired"==t.msg?a.show(a.alert().parent(angular.element(document.body)).title("Expired").content("Your password reset link has expired, please make a new request. Thank you.").ariaLabel("Expired").ok("OK!").targetEvent()):"wrongemail"==t.msg?alert("Wrong Email entered"):"0"==t.msg?alert("Something went wrong"):alert("updated successfully"),e.changeView("/login")):(console.log("something went wrong: "+o),e.resettoken="")}).error(function(t,o,n,r){console.log("Login AJAX Error! "+o),e.resettoken=""}))}}var t=angular.module("myApp");e.$inject=["$scope","$http","$cookieStore","$location","ENV","$routeParams","$mdDialog"],t.controller("ForgetCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a){e.token=o.get("admin_token")||o.get("employer_token"),void 0!==e.token&&(console.log("LoginCtrl: ******* Scope EMployer token = "),console.log(e.token),n.path("/login")),"1"===n.search().ftl?e.showFirstTimeLogin=!0:e.showFirstTimeLogin=!1,e.loginFn=function(i,l){return o.remove("employer_token"),o.remove("employer_token"),$(l.target).button("loading"),i&&i.email&&i.password?void t.post(r.rest_server+"employers/auth",i).success(function(t,r,i,c){console.log("LoginCtrl: AJAX is "+r),$(l.target).button("reset"),200===r?(console.log("LoginCtrl: storing token in cookie "+t.token),e.loginfail=!1,void 0!==t.token&&(o.put(t.type+"_token",t.token),o.put("name",t.name),s.name=o.get("name"),t.msgs&&a.show(a.alert().parent(angular.element(document.body)).title("Message").content(t.msgs).ariaLabel("Message").ok("Got it!").targetEvent()),e.$emit("loginout",""),n.path("/dashboard"))):(429==r&&a.show(a.alert().parent(angular.element(document.body)).title("Login attempts exceeded").content("You have exceeded your login attempt limit, please try again in 15 minutes. Thank you.").ariaLabel("Login attempts exceeded").ok("OK!").targetEvent()),console.log("oooh, something went wrong: "+r),e.token=!1)}).error(function(t,o,n,r){$(l.target).button("reset"),console.log("Login AJAX Error! "+o),e.token=!1,429==o&&a.show(a.alert().parent(angular.element(document.body)).title("Login attempts exceeded").content("You have exceeded your login attempt limit, please try again in 15 minutes. Thank you.").ariaLabel("Login attempts exceeded").ok("OK!").targetEvent())}):(e.errormsg="Email or password fields cannot be empty.",$(l.target).button("reset"),e.token=!1,!1)}}var t=angular.module("myApp");e.$inject=["$scope","$http","$cookieStore","$location","ENV","mySession","$mdDialog"],t.controller("LoginCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a,i,l,c,u,d,m){e.$on("newNotifications",function(t,o){e.notifications=o}),e.title1="Button",e.title4="Warn",e.isDisabled=!0,e.googleUrl="//google.com",e.toggleLeft=function(){c("left").toggle()},e.toggleRight=function(){c("right").toggle()},e.AWS_URL=a.aws_url,e.token=t.get("employer_token"),e.name=t.get("name"),e.parseInt=parseInt,e.$on("subname_upd",function(){e.subname=i.subname}),e.loggedIn=i.loggedIn(),e.hasEmployerToken=i.hasEmployerToken(),e.hasAdminToken=i.hasAdminToken(),console.log("mySession says: "+e.loggedIn),e.$on("loginout",function(){e.hasEmployerToken=i.hasEmployerToken(),e.hasAdminToken=i.hasAdminToken(),e.loggedIn=i.loggedIn(),e.name=i.name,e.subname=i.subname;var t=m.getNotifications();0!=t&&t.then(function(e){d.$broadcast("newNotifications",e)},function(e,t){console.error("Error loading notifications: "+t)})}),e.companyname=s.companyname,e.setPage=function(t){e.currentPage=t},e.filter=function(){n(function(){e.filteredItems=e.filtered.length},10)},e.sort_by=function(t){e.predicate=t,e.reverse=!e.reverse},e.goBack=function(){window.history.back()},e.changeView=function(e){r.path(e),console.log("Inside  ChangeView!!!!!!")},e.logout=function(){return t.remove("admin_token"),t.remove("admin_token"),t.remove("company"),t.remove("employer_token"),t.remove("employer_token"),t.remove("name"),i.name="",i.subname="",i.company="",e.name="",e.token=null,e.token=!1,e.notifications=0,console.log("Logging out... "),console.log("Cookie should be empty: "+t.get("employer_token")),e.loggedIn=i.loggedIn(),e.hasEmployerToken=i.hasEmployerToken(),e.hasAdminToken=i.hasAdminToken(),r.path("/login"),!1},e.isEmployer=function(){return i.loggedIn()},e.sizeLimit=10585760,e.uploadProgress=0,e.creds={},e.landing={},e.landingedit={},e.uploadermessage={},e.landingid=s.landingId,e.landing.type="photo",e.uploader={controllerFn:function(t,o,n){console.log(t,o,n),e.uploadermessage=angular.fromJson(n),e.landing.imageurl=e.uploadermessage.success,e.landingedit.imageurl=e.uploadermessage.success}},e.myupload=function(t){console.log("called my upload, token: "+e.token),t.files.length?""==e.landingedit.id||void 0==e.landingedit.id?o({url:a.rest_server+"emplanding?token="+e.token,data:e.landing,method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o,n,r){200===o?(console.log("successfully uploaded"),e.changeView("/landing")):console.log("Something went wrong with AJAX request: "+o)}).error(function(t,o,n,r){console.log("Login AJAX Error! "+o),e.token=!1}):o({url:a.rest_server+"emplanding?token="+e.token,data:e.landingedit,method:"PUT",headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o,n,r){200===o?e.changeView("/landing"):console.log("Something went wrong with AJAX request: "+o)}).error(function(t,o,n,r){console.log("Login AJAX Error! "+o),e.token=!1}).on("httpUploadProgress",function(t){e.uploadProgress=Math.round(t.loaded/t.total*100),e.$apply()}):""==e.landingedit.id||void 0==e.landingedit.id?toastr.error("Please select a file to upload"):o({url:a.rest_server+"emplanding?token="+e.token,data:e.landingedit,method:"PUT",headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o,n,r){200===o?e.changeView("/landing"):console.log("Something went wrong with AJAX request: "+o)}).error(function(t,o,n,r){console.log("Login AJAX Error! "+o),e.token=!1})},e.createothers=function(){""==e.landingedit.id||void 0==e.landingedit.id?o({url:a.rest_server+"emplanding?token="+e.token,data:e.landing,method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o,n,r){200===o?e.changeView("/landing"):console.log("Something went wrong with AJAX request: "+o)}).error(function(t,o,n,r){console.log("Login AJAX Error! "+o),e.token=!1}):o({url:a.rest_server+"emplanding?token="+e.token,data:e.landingedit,method:"PUT",headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o,n,r){200===o?e.changeView("/landing"):console.log("Something went wrong with AJAX request: "+o)}).error(function(t,o,n,r){console.log("Login AJAX Error! "+o),e.token=!1})},e.landingdelete=function(t,n){console.log("landing id to delete: "+t),o({url:a.rest_server+"emplanding?token="+e.token,data:{id:t},method:"DELETE",headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o,n,r){200===o?e.landingchunk=t:console.log("Something went wrong with AJAX request: "+o)}).error(function(t,o,n,r){console.log("Login AJAX Error! "+o),e.token=!1})},e.updateordering=function(t){o({url:a.rest_server+"emplanding/reordering?token="+e.token,data:t,method:"PUT",headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o,n,r){e.landingchunk=t}).error(function(e,t,o,n){console.log("Login AJAX Error! "+t)})},e.editlanding=function(t){e.changeView("/landedit/"+t)},e.fileSizeLabel=function(){return Math.round(e.sizeLimit/1024/1024)+"MB"},e.uniqueString=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;8>o;o++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},e.images=[],e.order=[],e.$watch("landingchunk",function(){e.images=[],angular.forEach(e.landingchunk,function(t,o){angular.forEach(t,function(e,t){var o={};o.url=a.aws_url+e.imageurl,o.caption=e.texdesc,o.thumbUrl=e.imageurl,this.push(o)},e.images)},e.images),e.order=[];var t=1,o={};o.ind=1,angular.forEach(e.landingchunk,function(n,r){angular.forEach(n,function(e,n){o=e,o.ind=t++,this.push(o)},e.order)},e.order),console.log(e.order)}),e.openLightboxModal=function(t){l.openModal(e.images,t)},e.loggedIn&&(console.log("employersCtrl -> Calling restserver emplanding controller"),o.get(a.rest_server+"emplanding?token="+e.token).success(function(t){e.landingchunk=t}),o.get(a.rest_server+"emplanding?landingid="+e.landingid+"&token="+e.token).success(function(t){e.landingedit=t})),e.showSimpleDialog=function(e,t,o){u.show(u.alert().parent(angular.element(document.body)).title(e).content(t).ariaLabel("Registration").ok("Got it!").targetEvent(o))}}var t=angular.module("myApp");e.$inject=["$scope","$cookieStore","$http","$timeout","$location","$routeParams","ENV","mySession","Lightbox","$mdSidenav","$mdDialog","$rootScope","InboxManager"],t.controller("employersCrtl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a,i,l,c,u){e.AWS_DOC="https://"+n.AWS_BUCKET+".s3.amazonaws.com/",console.log("In candApplicationCtrl "),i.jobid=s.jobid,i.jobtitle=s.jobtitle,e.jobtitle=i.jobtitle,e.jobid=s.jobid,e.token=o.get("employer_token"),e.behav_attrs=[],e.behav_vals=[],console.log("my get call = "+n.rest_server+"applications?jobid="+i.jobid+"&token="+e.token),e.getSchedule=function(){t.get(n.rest_server+"schedule?token="+o.get("employer_token")).success(function(t){e.schedules=t}).error(function(e,t){})},e.getSchedule(),t.get(n.rest_server+"applications?jobid="+i.jobid+"&token="+e.token).success(function(t,o){console.log("applicationsCtrl-> data:"+t),e.applicants=t,e.filterPage="APPLIED",e.showLoading=!1,console.log("applicationsCtrl: Got getting Application Data: "+o)}).error(function(e,t){console.log("applicationsCtrl: Error getting Jobs Data: "+t)}),e.filterApplications=function(t){switch(console.log("Filtering Triggered : "+t.first_name),e.filterPage){case"ALL":return!0;case"APPLIED":return"1"===t.status||"0"===t.status;case"SHORTLISTED":return"2"===t.status;case"INVITED":return"3"===t.status;case"HIRED":return"4"===t.status;case"ARCHIVED":return"5"===t.status;default:console.log("There should not be a default failover at this thing.")}},e.shortlist=function(t){a.shortlist(t,e.token),$mdToast.show($mdToast.simple().content("Applicant Shortlisted!").position("bottom").hideDelay(0))},e.setApplDetails=function(e){a.invited=e.invited,void 0!==e.invited_date&&(a.invited_date=e.invited_date,console.log("Parent controller applicationsCtrl -> service invited_date is now: "+a.invited_date))},s.candid&&s.application_id&&t.get(n.rest_server+"candidates?cand_id="+s.candid+"&application_id="+s.application_id+"&token="+e.token).success(function(t){e.profile=t[0],e.availability=t.availability,e.qas=t.qas,e.feedback=t.feedback,e.application=t.application,e.profile.shortlisted=s.shortlisted,e.profile.application_id=s.application_id,e.profile.invited=a.invited,e.profile.invited_date=a.invited_date,console.log("Invited date is: "+e.profile.invited_date),e.behavior=t.behavior,e.behav_attrs=t.behav_attrs,e.behav_vals=[t.behav_vals],console.log("candidateProfileCrtl returned: "),console.info(e.profile),e.showLoading=!1}),e.showLoading=!1,e.getPercentage=function(e){var t=parseInt(e.score)+parseInt(e.neg_score);return Math.round(e.score/t*100)},e.shortlist=function(t){a.shortlist(t,e.token)},e.showDialogEvent=function(t){u.show({controller:"EventCtrl",templateUrl:n.base_url+"assets/zpartials/emplr-events_d.html",parent:angular.element(document.body),targetEvent:t}).then(function(){e.getSchedule()},function(){});
},e.invite=function(o){console.log("Setting Invite"),t({url:n.rest_server+"applications?token="+e.token,method:"PUT",data:{application_id:o.application_id,set_invited:"1",email:o.email,subject:o.subject,msg:o.msg,jobid:i.jobid,eventid:o.eventid},headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o){return e.application.status=t.status.toString(),console.info(t),console.log("Invited successful"),!0}).error(function(e,t){return console.log("Problem Inviting: "+t),!1})},e.sendMessage=function(){console.log("Send a message..."),l.getConversationId(i.jobid,e.profile.id).then(function(e){var t=e;r.path("/inbox/conversation/"+t+"/"+i.jobid)},function(e,t){console.error("candApplicationCtrl: Error retrieving conversation by candidate: "+t)})},e.gotoConversation=function(){console.log("Send a message..."),l.getConversationId(i.jobid,e.profile.id).then(function(e){var t=e;r.path("/inbox/conversation/"+t+"/"+i.jobid)},function(e,t){console.error("candApplicationCtrl: Error retrieving conversation by candidate: "+t)})},e.gotoConversation=function(){console.log("Send a message..."),l.getConversationId(i.jobid,e.profile.id).then(function(e){var t=e;r.path("/inbox/conversation/"+t+"/"+i.jobid)},function(e,t){console.error("candApplicationCtrl: Error retrieving conversation by candidate: "+t)})},e.scrollToNotes=function(){r.hash("notes"),c()},e.saveNotes=function(){t({url:n.rest_server+"applications/notes?cand_id="+s.candid+"&application_id="+s.application_id+"&token="+e.token,method:"PUT",data:{notes:e.application.notes},headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(e,t){return 200==t?(u.show(u.alert().parent(angular.element(document.body)).title("Success!").content("You have successfully saved.").ariaLabel("Success").ok("OK!").targetEvent()),!0):void 0}).error(function(e,t){return alert("Unable to save notes."),!1})},e.changestatus=function(t,o,n,r){void 0==n&&(n=s.application_id),a.changeStatus(n,t,e.token,o,r)}}var t=angular.module("myApp");e.$inject=["$scope","$http","$cookieStore","ENV","$location","$routeParams","candShortlist","APPL","InboxManager","$anchorScroll","$mdDialog"],t.controller("candApplicationCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r){t.get(r.rest_server+"countries").success(function(t){e.countries=t,e.showLoading=!1}),e.showLoading=!1,e.getGeoCode=function(o,n){console.log("getGeoCode --->");var s=r.home_country;console.log("country id = "+s);var a=e.countries.filter(function(e){return e.id===s});a=a[0],console.log("selected Country"),console.log(a),t.get("https://maps.googleapis.com/maps/api/geocode/json?address="+a.name+"+ "+o).success(function(t){console.log(t),e.job.country_id=r.home_country,e.job.lat=t.results[0].geometry.location.lat,e.job["long"]=t.results[0].geometry.location.lng,console.log("lat = "+e.job.lat),console.log("long = "+e.job["long"])})},e.createJob=function(n,s){console.log(n),console.log(s.target),$(s.target).button("loading"),e.token=o.get("employer_token"),t({url:r.rest_server+"jobmgmt?token="+e.token,method:"POST",data:n,headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(e,t,o,n){console.log(e),console.log(t),$(s.target).button("reset"),201===t?window.location.href=r.base_url+"employers/":console.log("EmployerDashCreateJobCtrl: In else stmt")}).error(function(e,t,o,n){$(s.target).button("reset"),console.log("Error "+t)})},e.addRow=function(){e.questions.push({question_id:"",jobid:"",question:"",type:null})},e.deleteRow=function(t){e.questions.splice(t,1)}}var t=angular.module("myApp");e.$inject=["$scope","$http","$cookieStore","$location","ENV"],t.controller("EmployerDashCreateJobCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s){if(e.token=o.get("employer_token"),!e.token)return o.get("admin_token")?r.path("/admin"):r.path("/login"),!1;console.log("EmployerDashMainCtrl: Getting jobs for employer token "+e.token);var a="";void 0!==e.token?a="jobmgmt?token="+e.token:r.path("/login"),t.get(n.rest_server+a).success(function(t,o){400>o?(e.jobs=t.jobinfo,e.showLoading=!1):r.path("/login"),console.log("EmployerDashMainCtrl - Success, token valid, Status returned: "+o)}).error(function(e,t){console.log("EmployerDashMainCtrl: Error getting Jobs Data: "+t),r.path("/login")}),e.showLoading=!1,e.toggleStatus=function(o){t.get(n.rest_server+"job/toggleStatus?token="+e.token+"&jobid="+o.id).success(function(e,t){200==t&&(o.status=e.status,console.info(e))}).error(function(e){s.show(s.alert().parent(angular.element(document.body)).title("Expired").content("Your login session has expired, please login again.").ariaLabel("Expired Login").ok("OK!").targetEvent()),r.path("/login")})}}var t=angular.module("myApp");e.$inject=["$scope","$http","$cookieStore","ENV","$location","$mdDialog"],t.controller("EmployerDashMainCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a,i){e.token=a.get("employer_token"),e.jobId=s.jobid,console.log("you selected job id: "+s.jobid),t({url:r.rest_server+"jobmgmt/"+e.jobId+"?token="+e.token,method:"GET",headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(t,o){400>o?e.jobDet=t:(console.log("jobDetailsCtrl-> Something wrong!!!"),n.path("/login")),console.log("jobDetailsCtrl->Get Status returned: "+o),console.info(e.jobDet)}).error(function(e,t){console.log("jobDetailsCtrl: Error Get job>: "+t),n.path("/login")}),e.showLoading=!1,e.submitEdits=function(o){o.country_id=r.home_country,console.log("jobDetailsCtrl-> submitting the following Job for update: "),console.info(o.questions),t({url:r.rest_server+"jobmgmt/"+e.jobId+"?token="+e.token,method:"PUT",data:o[0],headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(s,a){400>a?(console.log(o[0]),t({url:r.rest_server+"questions?token="+e.token+"&id="+e.jobId,method:"PUT",data:o.questions,headers:{"Content-Type":"application/json; charset=UTF-8"}}).success(function(e){console.log("jobDetailsCtrl-> edited questions successfully:")}).error(function(e){console.log("jobDetailsCtrl: Error editing questions: "+e)})):n.path("/login"),console.log("jobDetailsCtrl-> edited job ID successfully: ")}).error(function(e,t){console.log("jobDetailsCtrl: Error editing job: "+t),n.path("/login")}),n.path("/job/jobid/"+o[0].id)},e.addRow=function(){e.jobDet.questions.push({question_id:"",job_id:e.jobId,question:"",type:null})},e.deleteRow=function(t){e.jobDet.questions.splice(t,1)},e.getGeoCode=function(o,n){6==o.length&&(selectedCountry="singapore",t.get("https://maps.googleapis.com/maps/api/geocode/json?address="+selectedCountry+"+ "+o).success(function(t){console.info(t),e.jobDet[0].lat=t.results[0].geometry.location.lat,e.jobDet[0]["long"]=t.results[0].geometry.location.lng,console.log("lat = "+e.job.lat),console.log("long = "+e.job["long"])}))}}var t=angular.module("myApp");e.$inject=["$scope","$http","$timeout","$location","ENV","$routeParams","$cookieStore","mySearchFields"],t.controller("jobDetailsCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a){e.advsearch=a.srch,e.$watch("advsearch.keyword",function(e,t){a.srch.keyword=e}),e.searchJobs=function(){console.log("jobsCtrl->searchJobs: searching Jobs"),e.srchstring="",a.srch.keyword&&(e.srchstring="/keyword/"+a.srch.keyword),a.srch.cat&&(e.srchstring=e.srchstring+"/category/"+a.srch.cat),a.srch.type&&(e.srchstring=e.srchstring+"/type/"+a.srch.type),a.srch.town&&(e.srchstring=e.srchstring+"/town/"+a.srch.town),e.srchstring&&(e.srchstring="/search"+e.srchstring),console.log("submitting for search: "+e.srchstring);var n=t.get("employer_token");n=n?n:"",o.get(s.rest_server+"jobs"+e.srchstring+"?token="+n).success(function(t){e.list=t,e.currentPage=1,e.entryLimit=5,e.filteredItems=e.list.length,e.totalItems=e.list.length,console.log("jobsCtrl->searchJobs: Success searching Jobs")}).error(function(e,t){console.log("jobsCtrl->searchJobs: Error searching Jobs : "+t)})},e.searchJobs(),e.isearch={keywords:"",cat:"",type:"",town:""},e.setCategory=function(t,o){a.srch.cat=t,e.catname=o,console.log("*****setting category to: "+e.isearch.cat)},e.setType=function(t,o){a.srch.type=t,e.typeName=o},e.setTown=function(t,o){a.srch.town=t,e.townName=o},e.setPage=function(t){e.currentPage=t},e.filter=function(){n(function(){e.filteredItems=e.filtered.length},10)},e.sort_by=function(t){e.predicate=t,e.reverse=!e.reverse}}var t=angular.module("myApp");e.$inject=["$scope","$cookieStore","$http","$timeout","$location","ENV","mySearch"],t.controller("jobsCrtl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a,i,l,c){e.AWS_URL=a.aws_url,e.token=t.get("employer_token"),e.sortableOptions={itemMoved:function(e){e.source.itemScope.modelValue.status=e.dest.sortableScope.$parent.column.name},orderChanged:function(e){},containment:"#board"},console.log("employerslandingCrtl -> token value: "+e.token),e.token||r.path("/login"),e.companyname=s.companyname,e.landingchunk={},e.setPage=function(t){e.currentPage=t},e.filter=function(){n(function(){e.filteredItems=e.filtered.length},10)},e.sort_by=function(t){e.predicate=t,e.reverse=!e.reverse},e.changeView=function(e){r.path(e)},e.logout=function(){return t.remove("employer_token"),t.remove("employer_token"),e.token=null,e.token=!1,console.log("Logging out... "),console.log("Cookie should be empty: "+t.get("employer_token")),e.loggedIn=i.loggedIn(),window.location=a.base_url+"employers#/login",!1},e.isEmployer=function(){return i.loggedIn()},e.landing={},e.$watch("companyname",function(){void 0!=e.companyname&&o.get(a.rest_server+"go/companyname/"+e.companyname).success(function(t){console.log(t),e.landingchunk=t})}),o.get(a.rest_server+"go/companyname/"+e.companyname).success(function(t){console.log(t),e.landingchunk=t}),e.images=[],e.order=[],e.$watch("landingchunk",function(){e.images=[],angular.forEach(e.landingchunk,function(t,o){angular.forEach(t,function(e,t){var o={};"pano"==e.type?(console.log("myvideo link"+e.videolink),o.url=c.trustAsResourceUrl(e.videolink)):o.url=c.trustAsResourceUrl(a.aws_url+e.imageurl),o.caption=e.texdesc,o.thumbUrl=e.imageurl,this.push(o)},e.images)},e.images),e.order=[],angular.forEach(e.landingchunk,function(t,o){angular.forEach(t,function(e,t){this.push(e)},e.order)},e.order)}),console.log(e.order),e.openLightboxModal=function(t){l.openModal(e.images,t)},e.openLightboxModal=function(t){l.templateUrl="<?php echo base_url();?>assets/components/angular-lightbox/lightbox.html",l.openModal(e.images,t)},e.openPanoModal=function(t){l.templateUrl="<?php echo base_url();?>assets/components/angular-lightbox/lightbox-pano.html",l.openModal(e.images,t)}}var t=angular.module("myApp");e.$inject=["$scope","$cookieStore","$http","$timeout","$location","$routeParams","ENV","mySession","Lightbox","$sce"],t.controller("employerslandingCrtl",e)}(),function(){"use strict";function e(e){return{restrict:"E",scope:{},link:function(t,o,n){t.url=e.trustAsResourceUrl(n.video),t.istyle=n.style},template:'<iframe allowfullscreen="" style="{{istyle}}" class="embed-responsive-item" ng-src="{{url}}"></iframe>'}}var t=angular.module("myApp");e.$inject=["$sce"],t.directive("youtubeBox",e)}(),function(){"use strict";function e(e,t,o,n,r,s){e.close=function(t){s.subname=r.get("subname"),e.$emit("subname_upd",""),n.path(t),o("left").close()}}var t=angular.module("myApp");e.$inject=["$scope","$timeout","$mdSidenav","$location","$cookieStore","mySession"],t.controller("LeftCtrl",e)}(),function(){"use strict";function e(e,t,o,n){e.isearch=n.srch,e.$watch("isearch.keyword",function(e,t){n.srch.keyword=e}),e.setCategory=function(t,o){n.setCategory(t,o),e.catname=o},e.setCategory=function(t,o){n.setCategory(t,o),e.catName=o},e.setType=function(t,o){n.srch.type=t,e.typeName=o},e.setTown=function(t,o){n.srch.town=t,e.townName=o},e.resetSrch=function(){n.resetSrch(),e.catName="",e.typeName="",e.townName=""},e.close=function(){o("right").close()}}var t=angular.module("myApp");e.$inject=["$scope","$timeout","$mdSidenav","mySearch"],t.controller("rightMenuCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s){function a(t){var o=$('div[class~="fc-bg"] [data-date="'+t+'"]');e.timeslots.dates[t]?(delete e.timeslots.dates[t],o.css("background-color",""),console.log("removed date"+t)):(e.timeslots.dates[t]=!0,o.css("background-color","#bce8f1"),console.log("added date"+t)),console.log(e.timeslots.dates),e.$apply()}function i(t){return e.timeslots.dates[t]?!0:void 0}function l(t){var o=$('div[class~="fc-bg"] [data-date="'+t+'"]');e.task.dates[t]?(delete e.task.dates[t],o.css("background-color",""),console.log("removed date"+t)):(e.task.dates[t]=!0,o.css("background-color","#bce8f1"),console.log("added date"+t)),console.log(e.task.dates),e.$apply()}function c(t){return e.task.dates[t]?!0:void 0}e.process="list",e.filterPage="EVENTS",e.resetSchedule=function(){e.schedule={title:"",desc:"",ongoing:"",enddate:""},e.task={dates:{},list:[]},e.timeslots={sch_id:null,starttime:"",endtime:"",ongoingdays:{},dates:{}}},e.resetSchedule(),e.getStyle=function(t){return 1==e.timeslots.ongoingdays[t]?"{'color':'blue'}":{}},e.getEndDate=function(){return e.timeslots.enddate},e.changePage=function(t){switch(e.process=t,t){case"list":e.resetSchedule();break;case"tasklist":e.process="list";break;case"selecttimefortask":e.task.dates={}}},$("#calendar").fullCalendar({selectable:!0,select:function(e,t,o,n){for(var r=e;r.format()!=t.format();)a(r.format()),r.add(1,"days")},dayClick:function(e,t,o){},viewRender:function(e,t){console.log("new view")},dayRender:function(e,t){console.log("new date"),i(e.format())&&(console.log("found"+e.format()),t.css("background-color","#bce8f1"))}}),$("#time").fullCalendar({defaultView:"agendaDay",allDaySlot:!1,header:!1,dayNames:["","","","","","",""],scrollTime:"00:00:00",selectable:!0,unselectAuto:!1,select:function(t,o,n,r){return t.hasTime()&&o.hasTime()?(console.log(t.format("HH:mm:ss")+" "+o.format("HH:mm:ss")),e.timeslots.starttime=t.format("HH:mm:ss"),e.timeslots.endtime=o.format("HH:mm:ss"),void e.$apply()):!1}}),e.submitSchedule=function(){n.get("employer_token")||o.path("/admin"),t.post(r.rest_server+"schedule/create?token="+n.get("employer_token"),e.schedule).success(function(t){e.resetSchedule(),e.getSchedule()}).error(function(e,t){})},e.submitTimeslot=function(){n.get("employer_token")||o.path("/admin");var s=[];for(var a in e.timeslots.ongoingdays)1==e.timeslots.ongoingdays[a]&&s.push(a);e.timeslots.ongoingdays=s.join();var i=[];for(var a in e.timeslots.dates)$('div[class~="fc-bg"] [data-date="'+a+'"]').css("background-color",""),1==e.timeslots.dates[a]&&i.push(a);e.timeslots.dates=i.join(),$("#time").fullCalendar("unselect"),t.post(r.rest_server+"schedule/addtimeslot?token="+n.get("employer_token"),e.timeslots).success(function(t){e.resetSchedule(),e.getSchedule(),e.changePage("list")}).error(function(e,t){})},e.getSchedule=function(){t.get(r.rest_server+"schedule?token="+n.get("employer_token")).success(function(t){e.schedules=t,e.changePage("list")}).error(function(e,t){})},e.getSchedule(),e.addTimeslot=function(t){e.changePage("selectdate"),e.timeslots.sch_id=t.id,e.selectedschedule=t},e.viewApplications=function(o,s){e.changePage("viewapplications"),e.selectedschedule=o,e.selectedtimeslot=s,t.post(r.rest_server+"schedule/getapplications?token="+n.get("employer_token"),{timeslot_id:s.timeslot_id}).success(function(t){e.applications=t}).error(function(e,t){})},e.publish=function(s){n.get("employer_token")||o.path("/admin"),t.post(r.rest_server+"schedule/publish?token="+n.get("employer_token"),{schedule_id:s}).success(function(t){"success"==t&&e.getSchedule()}).error(function(e,t){})},e.getWidth=function(e,t){return 0==t?100:100-100*((t-e)/t)},e.confirmApplication=function(s){n.get("employer_token")||o.path("/admin"),t.post(r.rest_server+"schedule/confirmapplication?token="+n.get("employer_token"),{application_id:s}).success(function(t){"success"==t&&(e.selectedtimeslot.confirmed=parseInt(e.selectedtimeslot.confirmed)+1,e.selectedtimeslot.unconfirmed=parseInt(e.selectedtimeslot.unconfirmed)-1,e.viewApplications(e.selectedschedule,e.selectedtimeslot))}).error(function(e,t){switch(e){case"alreadyselected":alert("You have already selected this timeslot.");break;case"novacancies":alert("There are no more vacancies for this timeslot.");break;case"appliedschedule":alert("You can only apply for one timeslot for this event.");break;case"notinvited":alert("This is a private event and you do not have invitation.");break;default:alert("You are not able to register for this timeslot. Please contact out admin for assistance.")}})},e.sumApplicants=function(e){return parseInt(e.confirmed)+parseInt(e.unconfirmed)},e.deleteTimeslot=function(o){return confirm("Delete timeslot?")?void t.post(r.rest_server+"schedule/deletetimeslot?token="+n.get("employer_token"),{timeslot_id:o}).success(function(t){"success"==t&&e.getSchedule()}).error(function(e,t){switch(e){case"alreadyselected":alert("You have already selected this timeslot.");break;case"novacancies":alert("There are no more vacancies for this timeslot.");break;case"appliedschedule":alert("You can only apply for one timeslot for this event.");break;case"notinvited":alert("This is a private event and you do not have invitation.");break;default:alert("You are not able to register for this timeslot. Please contact out admin for assistance.")}}):!1},e.editSchedule=function(e){e.editmode=!0},e.updateSchedule=function(o){o.editmode=!1,t.post(r.rest_server+"schedule/updateschedule?token="+n.get("employer_token"),{schedule:o}).success(function(t){e.getSchedule()}).error(function(t,o){alert("Update unsuccessful."),e.getSchedule()})},e.length=function(e){var t=0;for(key in e)t++;return t},$("#taskcalendar").fullCalendar({selectable:!0,select:function(e,t,o,n){for(var r=e;r.format()!=t.format();)l(r.format()),r.add(1,"days")},dayClick:function(e,t,o){},viewRender:function(e,t){console.log("new view")},dayRender:function(e,t){console.log("new date"),c(e.format())&&(console.log("found"+e.format()),t.css("background-color","#bce8f1"))}}),$("#tasktime").fullCalendar({defaultView:"agendaDay",allDaySlot:!1,header:!1,dayNames:["","","","","","",""],scrollTime:"00:00:00",selectable:!0,unselectAuto:!1,select:function(t,o,n,r){return t.hasTime()?(console.log(t.format("HH:mm:ss")+" "+o.format("HH:mm:ss")),e.task.starttime=t.format("HH:mm:ss"),void e.$apply()):!1}}),e.filterEvents=function(t){switch(e.filterPage){case"EVENTS":return console.log("filter: events"),"0"==t.type;case"TASKS":return"1"==t.type;default:console.log("There should not be a default failover at this thing.")}},e.addTask=function(){var t={};e.task.list.push(t)},e.deleteTask=function(t){e.task.list.splice(t,1)},e.submitTask=function(){n.get("employer_token")||o.path("/admin"),e.task.dates=e.datesToString(e.task.dates),"custom"==e.task.unit&&(e.task.unit=e.task.custom),$("#tasktime").fullCalendar("unselect"),t.post(r.rest_server+"schedule/createtask?token="+n.get("employer_token"),e.task).success(function(t){e.resetSchedule(),e.getSchedule()}).error(function(e,t){})},e.changeApplicationStatus=function(s,a){n.get("employer_token")||o.path("/admin"),t.post(r.rest_server+"schedule/changeappstatus?token="+n.get("employer_token"),{appid:s,status:a}).success(function(t){e.resetSchedule(),e.getSchedule()}).error(function(e,t){switch(e){case"notallowed":alert("You cannot make that status change.");break;case"notauthorized":alert("You are not authenticated to perform this action.");break;default:alert("Please contact out admin for assistance.")}})},e.datesToString=function(e){var t=[];for(var o in e)1==e[o]&&t.push(o);return t.join()}}var t=angular.module("myApp");e.$inject=["$scope","$http","$location","$cookieStore","ENV","$routeParams"],t.controller("CalendarCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a){e.resetSchedule=function(){e.schedule={title:"",desc:"",ongoing:"",enddate:""}},e.resetSchedule(),e.submitSchedule=function(){n.get("employer_token")||o.path("/admin"),t.post(r.rest_server+"schedule/create?token="+n.get("employer_token"),e.schedule).success(function(t){e.closeDialog()}).error(function(e,t){})},e.closeDialog=function(e){a.hide()}}var t=angular.module("myApp");e.$inject=["$scope","$http","$location","$cookieStore","ENV","$routeParams","$mdDialog"],t.controller("EventCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s,a,i){e.AWS_URL=s.aws_url,e.my_info=null,e.conversation_info=null,e.conversation=[],e.conversation_id=n.cid,e.job_id=n.jid,e.my_info=i.my_info,e.conversation_info=i.conversation,e.conversation=i.messages,r.resetConversationNotify(e.conversation_id),setTimeout(function(){o.hash("message_id"+e.conversation[e.conversation.length-1].message_id),console.log("Hash set MAIN to: message_id"+e.conversation[e.conversation.length-1].message_id),a(),document.getElementById("reply1").focus()},300),e.sendReply=function(t){void 0!==t&&""!==t&&r.postReply(e.conversation_id,t,e.job_id).then(function(t){e.refresh()},function(e,t){console.error("conversationCtrl: Error posting replay: "+t)})},e.goToInbox=function(){o.path("/inbox")},e.refresh=function(){r.getConversation(e.conversation_id).then(function(t){e.conversation=t.messages,o.hash("message_id"+e.conversation[e.conversation.length-1].message_id),console.log("Hash set to: message_id"+e.conversation[e.conversation.length-1].message_id),a(),document.getElementById("reply1").focus(),console.log("REFRESHED")},function(e,t){console.error("conversationCtrl: Error loading conversation: "+t)})}}var t=angular.module("myApp");e.$inject=["$scope","$route","$location","$routeParams","InboxManager","ENV","$anchorScroll","gconv"],t.controller("conversationCtrl",e)}(),function(){"use strict";function e(e,t,o,n){return{getMessages:function(){var r=e.defer(),s=o.get("employer_token");return console.log(n.rest_server+"messages?token="+s),t.get(n.rest_server+"messages?token="+s).success(function(e){r.resolve(e)}).error(function(e,t){r.reject(e,t)}),r.promise},getConversation:function(r){var s=e.defer(),a=o.get("employer_token");return console.log(n.rest_server+"messages/conversation/"+r+"?token="+a),t.get(n.rest_server+"messages/conversation/"+r+"?token="+a).success(function(e){s.resolve(e)}).error(function(e,t){s.reject(e,t)}),s.promise},postReply:function(r,s,a){var i=e.defer(),l=o.get("employer_token");return console.log(n.rest_server+"messages/reply/"+r+"?token="+l),t.post(n.rest_server+"messages/reply/"+r+"?token="+l,{reply:s,job_id:a}).success(function(e){i.resolve(e)}).error(function(e,t){i.reject(e,t)}),i.promise},getConversationId:function(r,s){var a=e.defer(),i=o.get("employer_token");return console.log(n.rest_server+"messages/init?token="+i),t.post(n.rest_server+"messages/init?token="+i,{job_id:r,candidate_id:s}).success(function(e){a.resolve(e)}).error(function(e,t){a.reject(e,t)}),a.promise},resetConversationNotify:function(r){var s=e.defer(),a=o.get("employer_token");return console.log(n.rest_server+"messages/reset/"+r+"?token="+a),t.get(n.rest_server+"messages/reset/"+r+"?token="+a).success(function(e){s.resolve(e)}).error(function(e,t){s.reject(e,t)}),s.promise},getNotifications:function(){var r=e.defer(),s=o.get("employer_token");return console.log(n.rest_server+"messages/notifications?token="+s),void 0==s?!1:(t.get(n.rest_server+"messages/notifications?token="+s).success(function(e){r.resolve(e)}).error(function(e,t){r.reject(e,t)}),r.promise)}}}var t=angular.module("myApp");e.$inject=["$q","$http","$cookieStore","ENV"],t.factory("InboxManager",e)}(),function(){"use strict";function e(e,t,o,n){e.search="",e.messages=[],n.getMessages().then(function(t){e.messages=t},function(e,t){console.error("inboxCtrl: Error loading messages: "+t)}),e.goToConversation=function(e){o.path("/inbox/conversation/"+e)},e.refresh=function(){t.reload()}}var t=angular.module("myApp");e.$inject=["$scope","$route","$location","InboxManager"],t.controller("inboxCtrl",e)}(),function(){"use strict";function e(e,t,o,n,r,s){function a(t){switch(e.format){case"2weeks":case"daily":return moment().set("year",t.year).set("month",t.month-1).set("date",t.day).format("DD/MM/YYYY");case"3months":return moment().set("year",t.year).set("month",t.month-1).set("date",t.day).format("MMM YYYY-WW");case"12months":case"yearly":return moment().set("year",t.year).set("month",t.month-1).format("MM/YYYY");case"hourly":return moment().set("hour",t.hour).format("hA")}}return e.token=r.get("employer_token"),e.token?(e.urlcount={},e.resetStats=function(){e.stats={visits:{total:0,url:"",count:0,percent:0},views:{count:0,title:""},favs:{count:0,title:""},refs:{count:0,title:""}},e.page={current:0,max:0,dataperpage:0},e.cdata=[],e.clabels=[]},e.resetStats(),e.getDataFromServer=function(o,s,a){var i="page";e.jobid?i="job":e.jobid="";var l=r.get("employer_token")?r.get("employer_token"):"";t.get(n.rest_server+"getstats?token="+l+"&type="+i+"&from="+o+"&to="+s+"&format="+a+"&jobid="+e.jobid).success(function(t){e.rdata=t,e.processData()}).error(function(e,t){})},e.getRefBy=function(t,o){if(o&&(e.job=o,e.jobid=o.id),e.format=t,!e.jobid)return console.log("not doing page ref"),!1;var n,r;switch(t){case"2weeks":n=moment().subtract(14,"days").format("YYYYMMDD"),r=moment().add(1,"days").format("YYYYMMDD");break;case"daily":n=moment().subtract(90,"days").format("YYYYMMDD"),r=moment().add(1,"days").format("YYYYMMDD");break;case"3months":n=moment().subtract(12,"weeks").format("YYYYMMDD"),r=moment().add(1,"days").format("YYYYMMDD");break;case"12months":n=moment().subtract(12,"months").format("YYYYMMDD"),r=moment().add(1,"days").format("YYYYMMDD");break;case"yearly":n=moment().subtract(2,"years").format("YYYYMMDD"),r=moment().add(1,"days").format("YYYYMMDD");break;default:n=moment().subtract(1,"months").format("YYYYMMDD"),r=moment().format("YYYYMMDD")}console.log("Getting "+e.format+"info from "+n+" to "+r),e.getDataFromServer(n,r,"")},e.onClick=function(t,o){if(console.log(t,o),"2weeks"!=e.format)return!1;var n=moment(t[0].label,"DD/MM/YYYY").format("YYYYMMDD"),r=moment(t[0].label,"DD/MM/YYYY").add(1,"days").format("YYYYMMDD");e.getDataFromServer(n,r,"hour"),e.format="hourly",e.subtitle="Hourly Stats for "+t[0].label},e.processData=function(){var t=[],o=[],n={},r={},s=0;e.urltotal=0;for(var i in e.rdata){var l=e.rdata[i];r[l.url]=parseInt(l.count)+parseInt(r[l.url]?r[l.url]:0),n[a(l)]=void 0!=n[a(l)]?n[a(l)]+parseInt(l.count):parseInt(l.count),n[a(l)]&&n[a(l)]>s&&(s=n[a(l)])}switch(e.format){case"hourly":for(var c=null,i=0;24>i;i++)c=moment().set("hour",i).format("hA"),o.push(n[c]?n[c]:0),t.push(c);break;case"daily":for(var c=null,i=90;i>=0;i--)c=moment().subtract(i,"days").format("DD/MM/YYYY"),o.push(n[c]?n[c]:0),t.push(c);e.subtitle="Daily Stats for 3 months";break;case"2weeks":for(var c=null,i=13;i>=0;i--)c=moment().subtract(i,"days").format("DD/MM/YYYY"),o.push(n[c]?n[c]:0),t.push(c);e.subtitle="Daily Stats for 2 weeks";break;case"monthly":for(var c=null,i=30;i>=0;i--)c=moment().subtract(i,"days").format("DD/MM/YYYY"),o.push(n[c]?n[c]:0),t.push(c);break;case"3months":for(var c=null,i=11;i>=0;i--)c=moment().set("day",1).subtract(i,"weeks").format("MMM YYYY-WW"),o.push(n[c]?n[c]:0),t.push(c);e.subtitle="Weekly Stats for 3 Months";break;case"12months":for(var c=null,i=11;i>=0;i--)c=moment().set("day",1).subtract(i,"months").format("MM/YYYY"),o.push(n[c]?n[c]:0),t.push(c);e.subtitle="Monthly Stats for 12 Months";break;case"yearly":for(var c=null,i=24;i>=0;i--)c=moment().set("day",1).subtract(i,"months").format("MM/YYYY"),o.push(n[c]?n[c]:0),t.push(c);e.subtitle="Monthly Stats for 24 Months";break;default:var t=[],o=[];for(var u in e.rdata){for(var d=e.rdata[u],c=a(d),m=!1,i=0;i<t.length;i++)if(t[i]==a(d)){o[i]=parseInt(o[i])+parseInt(d.count),m=!0;break}console.log("break!"),m||(t.push(a(d)),o.push(parseInt(d.count)))}}if(e.urlcount=r,0==o.length)return e.data=[[0]],e.label=["No Referrals"],e.page={current:0,max:0,dataperpage:0},!1;if("3months"==e.format){var g="";for(u in t)t[u]=t[u].substring(0,t[u].indexOf("-")),g==t[u]?t[u]="":g=t[u]}e.cdata=[o,[0==s?1:1.5*s]],e.clabels=t,"hourly"==e.format?e.colours=["#97BBCD","#FFFFFF"]:e.colours=["#FF5252","#FFFFFF"],e.presentData(o,t)},e.getJobs=function(){e.token=r.get("employer_token"),t.get(n.rest_server+"jobmgmt?token="+e.token).success(function(t,o){t.jobinfo.length>0?(e.resetStats(),e.jobs=t.jobinfo,e.refs=t.refinfo,e.getRefBy("2weeks",t.jobinfo[0])):$("#loadingjobs").text("No jobs available.")}).error(function(e,t){console.log("error")})},e.getJobs(),e.$watch("urlcount",function(){var t=0,o=0,n="";for(var r in e.urlcount)o+=parseInt(e.urlcount[r]),parseInt(e.urlcount[r])>t&&(t=e.urlcount[r],n=r);e.stats.visits={total:o,url:n,count:t,percent:o?(t/o*100).toFixed(2):0}}),e.getPercentage=function(t){return e.stats.visits.total?(t/e.stats.visits.total*100).toFixed(2):0},e.$watch("jobs",function(){for(var t in e.jobs)parseInt(e.jobs[t].num_views)>e.stats.views.count&&(e.stats.views.count=e.jobs[t].num_views,e.stats.views.title=e.jobs[t].title,console.log(e.stats.views.count),console.log(e.stats.views.title)),parseInt(e.jobs[t].fav)>e.stats.favs.count&&(e.stats.favs.count=e.jobs[t].fav,e.stats.favs.title=e.jobs[t].title)}),e.$watch("refs",function(){for(var t in e.refs)parseInt(e.refs[t].count)>e.stats.refs.count&&(e.stats.refs.count=e.refs[t].count,e.stats.refs.title=e.refs[t].refs)}),e.page={current:0,max:0,dataperpage:0},e.presentData=function(t,o){e.page.dataperpage=function(){switch(e.format){case"2weeks":return 14;case"hourly":return 12;case"3months":return 12;case"monthly":return 12;case"daily":return 12;case"12months":return 12;case"yearly":return 12}return 0}(),console.log("data per page:"+e.page.dataperpage),e.page.max=Math.ceil(t.length/e.page.dataperpage),console.log("max pages"+e.page.max),$("#pageslider").attr("max",e.page.max),console.log("set slider"),e.page.current=1,e.sliceData()},e.sliceData=function(){if(!e.cdata[0]||!e.clabels)return!1;var t=(parseInt(e.page.current)-1)*e.page.dataperpage;console.log("Page:"+e.page.current),console.log("Showing data:"+t+" to "+(t+e.page.dataperpage)),console.log("Max page:"+e.page.max),e.data=[e.cdata[0].slice(t,t+e.page.dataperpage),e.cdata[1]],e.labels=e.clabels.slice(t,t+e.page.dataperpage),console.log(e.data)},e.changePage=function(t){e.page.current+=t,e.page.current<=1&&(e.page.current=1),e.page.current>=e.page.max&&(e.page.current=e.page.max),e.sliceData()},void(e.getCurrentPage=function(){return parseInt(e.page.current)})):(s.path("/login"),!1)}var t=angular.module("myApp");e.$inject=["$scope","$http","$timeout","ENV","$cookieStore","$location"],t.controller("statsCtrl",e)}();